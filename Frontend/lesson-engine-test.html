<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trinity Capital Lesson Engine Tests</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #00ffcc, #00b3a6);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        margin: 0;
        font-size: 2.2em;
        font-weight: 700;
      }

      .header p {
        margin: 10px 0 0 0;
        font-size: 1.1em;
        opacity: 0.9;
      }

      .content {
        padding: 30px;
      }

      .test-controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .test-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1em;
        font-weight: 600;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .test-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
      }

      .test-button.primary {
        background: linear-gradient(135deg, #00b3a6, #00998a);
      }

      .test-button.secondary {
        background: linear-gradient(135deg, #ffc107, #ff8c00);
      }

      .test-output {
        background: #1e1e1e;
        color: #f8f8f2;
        border-radius: 8px;
        padding: 20px;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        line-height: 1.4;
        max-height: 600px;
        overflow-y: auto;
        white-space: pre-wrap;
        margin-top: 20px;
      }

      .scenario-info {
        background: #f8f9fa;
        border-left: 4px solid #00b3a6;
        padding: 15px 20px;
        margin: 20px 0;
        border-radius: 0 8px 8px 0;
      }

      .scenario-info h3 {
        margin: 0 0 10px 0;
        color: #00b3a6;
      }

      .grade-examples {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .grade-card {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        padding: 15px;
        text-align: center;
        transition: border-color 0.2s;
      }

      .grade-card:hover {
        border-color: #00b3a6;
      }

      .grade-letter {
        font-size: 2em;
        font-weight: 700;
        margin-bottom: 5px;
      }

      .grade-letter.a {
        color: #28a745;
      }
      .grade-letter.b {
        color: #17a2b8;
      }
      .grade-letter.c {
        color: #ffc107;
      }
      .grade-letter.d {
        color: #fd7e14;
      }
      .grade-letter.f {
        color: #dc3545;
      }

      .loading {
        display: none;
        text-align: center;
        padding: 20px;
        color: #666;
      }

      .loading.show {
        display: block;
      }

      .spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #00b3a6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-right: 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .clear-btn {
        background: #6c757d;
        margin-left: 10px;
      }

      .results-summary {
        background: linear-gradient(135deg, #e8f5e8, #d4edda);
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        border-left: 4px solid #28a745;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>
          <i class="fa-solid fa-graduation-cap"></i> Trinity Capital Lesson
          Engine Tests
        </h1>
        <p>
          Comprehensive testing of automatic lesson completion and grading
          system
        </p>
      </div>

      <div class="content">
        <div class="scenario-info">
          <h3><i class="fa-solid fa-info-circle"></i> Testing Overview</h3>
          <p>
            This test suite demonstrates various student learning patterns and
            their corresponding grades:
          </p>
          <ul>
            <li>
              <strong>Perfect Students:</strong> View content + complete all app
              actions ‚Üí A grades
            </li>
            <li>
              <strong>App-Focused Students:</strong> Learn primarily through
              hands-on practice ‚Üí A- to B+ grades
            </li>
            <li>
              <strong>Content-Only Students:</strong> Read materials but don't
              practice ‚Üí B- to C+ grades
            </li>
            <li>
              <strong>Struggling Students:</strong> Incomplete work + mistakes ‚Üí
              C to B- grades
            </li>
            <li>
              <strong>Slider-Only Lessons:</strong> No quiz, just content
              viewing ‚Üí Auto 100% grade
            </li>
          </ul>
        </div>

        <div class="grade-examples">
          <div class="grade-card">
            <div class="grade-letter a">A+</div>
            <div>97-100%</div>
            <small>Exceptional mastery</small>
          </div>
          <div class="grade-card">
            <div class="grade-letter a">A</div>
            <div>93-96%</div>
            <small>Excellent understanding</small>
          </div>
          <div class="grade-card">
            <div class="grade-letter b">B+</div>
            <div>87-92%</div>
            <small>Good performance</small>
          </div>
          <div class="grade-card">
            <div class="grade-letter c">C+</div>
            <div>77-82%</div>
            <small>Satisfactory work</small>
          </div>
          <div class="grade-card">
            <div class="grade-letter d">D</div>
            <div>63-69%</div>
            <small>Needs improvement</small>
          </div>
        </div>

        <div class="test-controls">
          <button class="test-button primary" onclick="runAllTests()">
            <i class="fa-solid fa-play"></i>
            Run All Test Scenarios
          </button>

          <button class="test-button secondary" onclick="runSliderOnlyTest()">
            <i class="fa-solid fa-star"></i>
            Test Slider-Only (100%)
          </button>

          <button class="test-button" onclick="runQuizDemo()">
            <i class="fa-solid fa-brain"></i>
            Demonstrate Quiz Integration
          </button>

          <button class="test-button" onclick="runEdgeCases()">
            <i class="fa-solid fa-bug"></i>
            Test Edge Cases
          </button>

          <button class="test-button" onclick="runIndividualTest(0)">
            <i class="fa-solid fa-user-graduate"></i>
            Perfect Student Test
          </button>

          <button class="test-button" onclick="runIndividualTest(2)">
            <i class="fa-solid fa-user-clock"></i>
            Struggling Student Test
          </button>
        </div>

        <div style="text-align: center">
          <button class="test-button clear-btn" onclick="clearOutput()">
            <i class="fa-solid fa-trash"></i>
            Clear Output
          </button>
          <button class="test-button clear-btn" onclick="refreshLessons()">
            <i class="fa-solid fa-refresh"></i>
            Refresh Lessons
          </button>
          <button class="test-button clear-btn" onclick="checkServerStatus()">
            <i class="fa-solid fa-server"></i>
            Check Server
          </button>
        </div>

        <div class="loading" id="loading">
          <div class="spinner"></div>
          Running tests... Please wait.
        </div>

        <div class="test-output" id="output">
          Click a test button above to see results here. üéì Available Test
          Scenarios: 1. Perfect Student - Views content + completes all actions
          2. App-Focused Student - Learns through hands-on practice 3.
          Struggling Student - Some progress but makes mistakes 4. Content-Only
          Student - Reads everything but no app usage 5. Overachiever - Does
          everything + extra actions 6. Slider-Only - Content viewing only, auto
          100% grade
        </div>
      </div>
    </div>

    <!-- Import the lesson engine and test scripts -->
    <script type="module">
      import {
        initializeLessonWithRequirements,
        recordLessonAction,
        recordLessonMistake,
        lessonTracker,
        completeLesson,
      } from './Javascript/lessonEngine.js';

      // Sample lessons for testing - will be replaced with real data
      let testLessons = {
        banking_basics: {
          lesson_title: 'Banking Basics',
          content: `# Welcome to Banking Basics\n\nBANKING BASICS:\nUnderstanding how banks work is crucial for financial success.\n\n## Types of Accounts\n\nCHECKING ACCOUNTS:\nUsed for daily transactions and bill payments.\n\nSAVINGS ACCOUNTS:\nHelp you save money and earn interest over time.\n\n## Banking Services\n\nBanks offer online banking, mobile apps, and customer support to help manage your finances effectively.`,
          requiredActions: [
            'deposit_made',
            'account_checked',
            'transfer_completed',
          ],
        },
        investment_intro: {
          lesson_title: 'Introduction to Investing',
          content: `# Introduction to Investing\n\nWHAT IS INVESTING?\nPutting your money to work to earn more money over time.\n\n## Why Invest?\n\nInvesting helps build wealth and reach financial goals.\n\nSTOCKS:\nRepresent ownership in companies.\n\nBONDS:\nLoans to companies or governments that pay interest.`,
          requiredActions: ['investment_made', 'goal_set'],
        },
        slider_only: {
          lesson_title: 'Quick Banking Overview',
          content: `# Quick Banking Overview\n\nBANK ACCOUNTS:\nTwo main types of accounts exist.\n\nCHECKING:\nFor daily spending.\n\nSAVINGS:\nFor saving money.\n\nThat's the basics!`,
          requiredActions: [],
        },
      };

      // Fetch real lessons from admin@trinity-capital.net
      const fetchAdminLessons = async () => {
        try {
          log('üîó Attempting to connect to server on port 4000...');
          const response = await fetch('http://localhost:4000/admin-lessons');

          // Check if response is HTML (server not running or wrong endpoint)
          const contentType = response.headers.get('content-type');
          if (contentType && contentType.includes('text/html')) {
            log(
              '‚ö†Ô∏è Server returned HTML instead of JSON - server may not be running',
            );
            log('üí° Please start your Node.js server with: node server.js');
            return {};
          }

          if (!response.ok) {
            log(
              `‚ùå Server responded with status: ${response.status} ${response.statusText}`,
            );
            return {};
          }

          const data = await response.json();

          if (data.success && data.lessons.length > 0) {
            log(
              `‚úÖ Loaded ${data.lessons.length} real lessons from admin@trinity-capital.net`,
            );

            // Convert database lessons to test format
            const realLessons = {};
            data.lessons.forEach((lesson, index) => {
              const key = `lesson_${index + 1}`;
              realLessons[key] = {
                lesson_title:
                  lesson.lesson_title || lesson.title || `Lesson ${index + 1}`,
                content:
                  lesson.content ||
                  lesson.lesson_content ||
                  `# ${lesson.lesson_title}\n\nContent for ${lesson.lesson_title}`,
                requiredActions: extractRequiredActions(
                  lesson.content || lesson.lesson_content || '',
                ),
                _id: lesson._id,
                creator:
                  lesson.creator_email ||
                  lesson.creator_username ||
                  'admin@trinity-capital.net',
              };
            });

            // Replace sample lessons with real ones
            testLessons = { ...testLessons, ...realLessons };
            log(
              `üìö Using ${Object.keys(realLessons).length} real lessons + ${Object.keys(testLessons).length - Object.keys(realLessons).length} sample lessons`,
            );

            return realLessons;
          } else if (data.success && data.lessons.length === 0) {
            log(
              '‚ö†Ô∏è Admin lessons collection is empty - no lessons found for admin@trinity-capital.net',
            );
            log(
              'üí° Create some lessons as admin@trinity-capital.net to test with real data',
            );
            return {};
          } else {
            log('‚ö†Ô∏è No admin lessons found, using sample lessons for testing');
            return {};
          }
        } catch (error) {
          if (error.name === 'TypeError' && error.message.includes('fetch')) {
            log('‚ùå Cannot connect to server - is Node.js server running?');
            log(
              'üí° Start server with: cd to your project folder, then run: node server.js',
            );
          } else {
            log(`‚ùå Error fetching admin lessons: ${error.message}`);
          }
          log('üìö Falling back to sample lessons for testing');
          return {};
        }
      };

      // Extract required actions from lesson content
      const extractRequiredActions = content => {
        const actions = [];

        // Look for common banking actions mentioned in content
        if (content.toLowerCase().includes('deposit')) {
          actions.push('deposit_made');
        }
        if (content.toLowerCase().includes('transfer')) {
          actions.push('transfer_completed');
        }
        if (content.toLowerCase().includes('invest')) {
          actions.push('investment_made');
        }
        if (
          content.toLowerCase().includes('account') ||
          content.toLowerCase().includes('balance')
        ) {
          actions.push('account_checked');
        }
        if (content.toLowerCase().includes('goal')) {
          actions.push('goal_set');
        }
        if (
          content.toLowerCase().includes('send') ||
          content.toLowerCase().includes('payment')
        ) {
          actions.push('send_money');
        }

        // If no specific actions found, it's a content-only lesson
        return actions;
      };

      // Test scenarios - will be updated with real lessons
      let testScenarios = [
        {
          name: 'Perfect Student',
          lesson: testLessons.banking_basics,
          actions: [
            {
              type: 'lesson_content_viewed',
              details: { slidesViewed: 8, totalSlides: 8 },
            },
            { type: 'deposit_made', details: { amount: 500 } },
            { type: 'account_checked', details: { accountType: 'checking' } },
            { type: 'transfer_completed', details: { amount: 100 } },
          ],
          mistakes: [],
          description: 'Views all content and completes all required actions',
        },
        {
          name: 'App-Focused Student',
          lesson: testLessons.investment_intro,
          actions: [
            { type: 'investment_made', details: { amount: 1000 } },
            {
              type: 'goal_set',
              details: { goal: 'retirement', amount: 50000 },
            },
            { type: 'investment_made', details: { amount: 500 } },
          ],
          mistakes: [],
          description: 'Learns through hands-on practice',
        },
        {
          name: 'Struggling Student',
          lesson: testLessons.banking_basics,
          actions: [
            {
              type: 'lesson_content_viewed',
              details: { slidesViewed: 4, totalSlides: 8 },
            },
            { type: 'account_checked', details: { accountType: 'checking' } },
          ],
          mistakes: [
            {
              type: 'financial_mistake',
              details: { type: 'overdraft', amount: -50 },
            },
          ],
          description: 'Makes some progress but has difficulties',
        },
      ];

      // Update test scenarios with real lessons when available
      const updateTestScenariosWithRealLessons = realLessons => {
        const lessonKeys = Object.keys(realLessons);
        if (lessonKeys.length > 0) {
          // Update existing scenarios with real lessons
          if (lessonKeys[0]) {
            testScenarios[0].lesson = realLessons[lessonKeys[0]];
            log(
              `üìù Updated Perfect Student test with: "${realLessons[lessonKeys[0]].lesson_title}"`,
            );
          }
          if (lessonKeys[1]) {
            testScenarios[1].lesson = realLessons[lessonKeys[1]];
            log(
              `üìù Updated App-Focused test with: "${realLessons[lessonKeys[1]].lesson_title}"`,
            );
          }
          if (lessonKeys[2]) {
            testScenarios[2].lesson = realLessons[lessonKeys[2]];
            log(
              `üìù Updated Struggling Student test with: "${realLessons[lessonKeys[2]].lesson_title}"`,
            );
          }

          // Add additional scenarios for more real lessons
          lessonKeys.slice(3).forEach((key, index) => {
            const lesson = realLessons[key];
            testScenarios.push({
              name: `Real Lesson Test ${index + 4}`,
              lesson: lesson,
              actions: [
                {
                  type: 'lesson_content_viewed',
                  details: { slidesViewed: 6, totalSlides: 8 },
                },
                ...lesson.requiredActions.slice(0, 2).map(action => ({
                  type: action,
                  details: { amount: 300, accountType: 'checking' },
                })),
              ],
              mistakes: [],
              description: `Tests real lesson: "${lesson.lesson_title}"`,
            });
          });
        }
      };

      // Utility functions
      function log(message) {
        const output = document.getElementById('output');
        output.textContent += message + '\n';
        output.scrollTop = output.scrollHeight;
      }

      function clearLog() {
        document.getElementById('output').textContent = '';
      }

      function showLoading() {
        document.getElementById('loading').classList.add('show');
      }

      function hideLoading() {
        document.getElementById('loading').classList.remove('show');
      }

      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      // Reset lesson tracker
      function resetTracker() {
        lessonTracker.currentLesson = null;
        lessonTracker.positiveConditionsMet = [];
        lessonTracker.negativeConditionsTriggered = [];
        lessonTracker.quizScores = [];
        lessonTracker.startTime = null;
        lessonTracker.endTime = null;
        lessonTracker.requiredConditions = [];
        lessonTracker.contentScore = 0;
        lessonTracker.appUsageScore = 70;
      }

      // Run individual test
      async function runTest(scenario, index) {
        log(`\nüß™ Test ${index + 1}: ${scenario.name}`);
        log(`üìù ${scenario.description}`);
        log('‚îÄ'.repeat(50));

        const lessonId = `test_${index + 1}`;
        initializeLessonWithRequirements(
          lessonId,
          scenario.lesson.lesson_title,
          scenario.lesson.requiredActions,
        );

        await sleep(300);

        // Record actions
        for (const action of scenario.actions) {
          log(`‚úÖ ${action.type}: ${JSON.stringify(action.details)}`);
          recordLessonAction(action.type, action.details);
          await sleep(150);
        }

        // Record mistakes
        for (const mistake of scenario.mistakes) {
          log(`‚ùå ${mistake.type}: ${JSON.stringify(mistake.details)}`);
          recordLessonMistake(mistake.type, mistake.details);
          await sleep(150);
        }

        // Get progress
        const progress = lessonTracker.getLessonProgress();
        if (progress) {
          log(`üìä Progress: ${progress.progress.toFixed(1)}%`);
          log(
            `üìö Content: ${progress.contentScore}/30, üíª App: ${progress.appUsageScore}/70`,
          );
          log(`üéØ Combined Score: ${progress.combinedScore}/100`);

          if (!progress.isComplete) {
            log('üîÑ Manually completing...');
            const result = completeLesson({
              completionType: 'manual',
            });
            if (result) {
              log(
                `üéâ Final Grade: ${result.score.finalScore} (${result.score.grade})`,
              );
            }
          }
        }

        log('‚îÄ'.repeat(50));
        resetTracker();
      }

      // Make all functions globally available
      const assignGlobalFunctions = () => {
        // Global functions for buttons
        window.runAllTests = async function () {
          showLoading();
          clearLog();
          log('üöÄ Starting Trinity Capital Lesson Engine Tests');
          log('‚ïê'.repeat(60));

          for (let i = 0; i < testScenarios.length; i++) {
            await runTest(testScenarios[i], i);
            await sleep(500);
          }

          log('üéä All tests completed!');
          hideLoading();
        };

        window.runIndividualTest = async function (index) {
          if (testScenarios[index]) {
            showLoading();
            clearLog();
            await runTest(testScenarios[index], index);
            hideLoading();
          }
        };

        window.runSliderOnlyTest = async function () {
          showLoading();
          clearLog();

          log('üåü Testing Slider-Only Lesson (Auto 100%)');
          log('‚ïê'.repeat(50));

          initializeLessonWithRequirements(
            'slider_test',
            testLessons.slider_only.lesson_title,
            testLessons.slider_only.requiredActions,
          );

          await sleep(300);

          recordLessonAction('lesson_content_viewed', {
            slidesViewed: 4,
            totalSlides: 4,
          });

          log('‚úÖ Viewed all 4 slides');

          await sleep(300);

          // Since no app actions are required, this should manually complete at 100%
          const result = completeLesson({
            message: 'Perfect! Content-only lesson completed!',
            baseScore: 100,
            completionType: 'content_only',
          });

          if (result) {
            log(
              `üéâ Final Grade: ${result.score.finalScore} (${result.score.grade})`,
            );
            log(
              '‚ú® Slider-only lessons automatically receive 100% when all content is viewed!',
            );
          }

          resetTracker();
          hideLoading();
        };

        window.runQuizDemo = async function () {
          showLoading();
          clearLog();

          log('üß† Quiz Integration Demo');
          log('‚ïê'.repeat(40));

          initializeLessonWithRequirements('quiz_demo', 'Quiz Demo Lesson', [
            'deposit_made',
          ]);

          recordLessonAction('lesson_content_viewed', {
            slidesViewed: 5,
            totalSlides: 5,
          });
          recordLessonAction('deposit_made', { amount: 300 });

          // Add quiz scores
          lessonTracker.addQuizScore(88, 100, 'Banking Quiz');
          lessonTracker.addQuizScore(95, 100, 'Security Quiz');

          log('üìã Added quiz scores:');
          log('   ‚Ä¢ Banking Quiz: 88/100');
          log('   ‚Ä¢ Security Quiz: 95/100');
          log('‚ú® Lesson auto-completed with quiz integration!');

          resetTracker();
          hideLoading();
        };

        window.runEdgeCases = async function () {
          showLoading();
          clearLog();

          log('üîç Edge Case Tests');
          log('‚ïê'.repeat(30));

          // Test: Only mistakes
          log('\nTest: Student makes only mistakes');
          initializeLessonWithRequirements('edge_test', 'Edge Case Test', [
            'deposit_made',
          ]);
          recordLessonMistake('financial_mistake', {
            type: 'overdraft',
            amount: -50,
          });
          const progress = lessonTracker.getLessonProgress();
          log(`Result: App score reduced to ${lessonTracker.appUsageScore}/70`);

          resetTracker();
          hideLoading();
        };

        window.clearOutput = function () {
          clearLog();
          log('Output cleared. Click a test button to run tests.');
        };
      };

      // Call the function to assign global functions
      assignGlobalFunctions();

      // Initialize the test suite
      const initializeTestSuite = async () => {
        log('üöÄ Initializing Trinity Capital Lesson Engine Test Suite...');
        log(
          'üìä Attempting to load real lessons from admin@trinity-capital.net...',
        );

        const realLessons = await fetchAdminLessons();
        updateTestScenariosWithRealLessons(realLessons);

        log('‚ïê'.repeat(60));
        log('üéì Trinity Capital Lesson Engine Test Suite Ready');

        const realLessonCount = Object.keys(realLessons).length;
        const sampleLessonCount =
          Object.keys(testLessons).length - realLessonCount;

        if (realLessonCount > 0) {
          log(`üìö Test Suite Contains ${testScenarios.length} scenarios:`);
          log(`   ‚Ä¢ ${realLessonCount} real lessons from database`);
          log(`   ‚Ä¢ ${sampleLessonCount} sample lessons for testing`);
        } else {
          log(
            `üìö Test Suite Contains ${testScenarios.length} scenarios using sample data`,
          );
          log('üí° To test with real lessons:');
          log('   1. Make sure your Node.js server is running');
          log('   2. Create lessons as admin@trinity-capital.net');
          log('   3. Click "Refresh Lessons" or "Check Server"');
        }

        log('');
        testScenarios.forEach((scenario, index) => {
          const creator = scenario.lesson.creator
            ? ` (by ${scenario.lesson.creator})`
            : ' (sample)';
          log(
            `   ${index + 1}. ${scenario.name}: "${scenario.lesson.lesson_title}"${creator}`,
          );
        });
        log('‚ïê'.repeat(60));
        log('üöÄ Ready to test! Click any button above to begin.');
        log('');
      };

      // Add function to refresh lessons
      window.refreshLessons = async function () {
        showLoading();
        clearLog();
        log('üîÑ Refreshing lessons from database...');
        await initializeTestSuite();
        hideLoading();
      };

      // Add function to check server status
      window.checkServerStatus = async function () {
        showLoading();
        clearLog();
        log('üîç Checking server status...');

        try {
          // Try to fetch from a simple endpoint first
          const response = await fetch('http://localhost:4000/admin-lessons');
          const contentType = response.headers.get('content-type');

          if (contentType && contentType.includes('text/html')) {
            log('‚ùå Server is responding but returning HTML');
            log(
              'üí° This means the endpoint might not exist or server routing is wrong',
            );
            log(
              'üîß Check that /admin-lessons endpoint is properly defined in server.js',
            );
          } else if (response.ok) {
            const data = await response.json();
            log('‚úÖ Server is running and responding correctly!');
            log(
              `üìä Found ${data.lessons ? data.lessons.length : 0} lessons in database`,
            );
            if (data.lessons && data.lessons.length > 0) {
              log('üéâ Ready to test with real lesson data!');
            } else {
              log(
                'üí° Database connected but no lessons found for admin@trinity-capital.net',
              );
            }
          } else {
            log(
              `‚ö†Ô∏è Server responded with status: ${response.status} ${response.statusText}`,
            );
          }
        } catch (error) {
          log('‚ùå Cannot connect to server');
          log('üí° Make sure to start your Node.js server:');
          log('   1. Open terminal in your project folder');
          log('   2. Run: node server.js');
          log('   3. Look for "Server running on port 3000" message');
          log('   4. Then refresh this page and try again');
        }

        hideLoading();
      };

      // Initialize on page load
      initializeTestSuite();
    </script>
  </body>
</html>
